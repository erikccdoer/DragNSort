(function(a,b,c){"use strict";function e(b,d){function C(){for(var b=0;q>b;b++){if(r[b]={x:0,y:0,width:0,height:0},o[b])for(var c in i)o[b].style[c]=i[c];K(o[b],k.childClassName)}if(D(),F(),m)for(var c in j)m.style[c]=j[c];s=a(m,{drag_lock_to_axis:!0,hold_timeout:k.dragTimeout}).on("touch dragleft dragright release hold tap",Q),m.addEventListener("webkitTransitionEnd",A,!1),m.addEventListener("msTransitionEnd",A,!1),m.addEventListener("oTransitionEnd",A,!1),m.addEventListener("otransitionend",A,!1),m.addEventListener("transitionend",A,!1)}function D(){p=m.getBoundingClientRect();for(var a,i,b=0,c=p.right-p.left,d=0,j=k.margins[e],l=0;q>l;l++)a=o[l].getBoundingClientRect(),d=a.right-a.left,i=l?r[l-1].x+r[l-1].width+k.margins[h]+k.margins[f]:k.margins[h],r[l].width=d,r[l].height=a.bottom-a.top,b=b>=r[l].height?b:r[l].height,d+i>c&&(i=k.margins[h],j+=b+k.margins[e]+k.margins[g]),r[l].x=i,r[l].y=j,r[l].animating=!1,H(l,1);m.style.height=r[q-1].y+b+k.margins[g]+"px"}function E(a){var b=M(a.target);b>-1&&(r[b].animating=!1),v||0>a.propertyName.search("transform")||t==a.target&&(t=u=!1,F(),k.onDragEnd&&k.onDragEnd.call(m,{elements:o}))}function F(){for(var a,b=0;q>b;b++)for(var c=b+1;q>c;c++)(r[b].x>r[c].x||r[b].y>r[c].y)&&(a=o[c],o[c]=o[b],o[b]=a,a=r[c],r[c]=r[b],r[b]=a)}function G(a,b,c,d){var e=o[a],f=e&&e.style;f&&(f.webkitTransitionDuration=f.MozTransitionDuration=f.msTransitionDuration=f.OTransitionDuration=f.transitionDuration=(c?c:0===c?0:k.translateSpeed)+"ms",f.webkitTransform="translate("+b+"px, "+d+"px) "+(v&&u===a?k.onDragTransform:""),f.msTransform=f.MozTransform=f.OTransform="translateX("+b+"px) translateY("+d+"px) "+(v&&u===a?k.onDragTransform:""))}function H(a,b){G(a,r[a].x,b,r[a].y)}function I(a,b){return a.className&&a.className.match(RegExp("(\\s|^)"+b+"(\\s|$)"))}function J(a,b){if(I(a,b)){var c=RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c,"")}}function K(a,b){I(a,b)||(a.className+=" "+b)}function L(a){return I(a,k.childClassName)?a:a.parentNode&&a.parentNode!=m?L(a.parentNode):void 0}function M(a){for(var b=-1,c=0;o.length>c;c++)o[c]==a&&(b=c);return b}function O(a,b){for(var c,d,e,f,n,l=1e9,m=-1,o=0;q>o;o++)a!=o&&(c=r[o].x+.5*r[o].width,d=b,e=r[o].y+.5*r[o].height,f=r[a].y+.5*r[a].height,n=Math.sqrt((d-c)*(d-c)+(f-e)*(f-e)),l>n&&(l=n,m=o));return k.minPxTriggerSwap>l?m:-1}function P(a,b){var c=r[a].x,d=r[b].x;d>c?(r[b].x=c,r[a].x+=r[b].width+k.margins[1]):(r[a].x=d,r[b].x+=r[a].width+k.margins[1])}function Q(a){if(a.target!=m)switch(a.type){case"tap":if(v)return a.gesture.preventDefault(),a.gesture.stopPropagation(),void 0;k.onTap&&k.onTap.call(L(a.target),a);break;case"hold":v=!0,t=L(a.target),K(t,k.draggingClassName),u=M(t),w=r[u].x,x=r[u].y,H(u),a.gesture.touches.length>1&&alert(2);break;case"dragright":case"dragleft":if(!v)return;a.gesture.preventDefault(),a.gesture.stopPropagation();var b=w+a.gesture.deltaX;G(u,b,0,x);var c=O(u,b+.5*r[u].width);c>-1&&(P(u,c),H(c),r[c].animating=!0);break;case"release":if(!v)return;v=!1,J(t,k.draggingClassName),H(u)}}var p,s,t,u,v,w,x,e=0,f=1,g=2,h=3,i={position:"absolute"},j={position:"relative"},k={childClassName:"e-grid",draggingClassName:"dragging",translateSpeed:300,collideOffsetPx:0,margins:[0,0,0,0],onTap:c,onDragTransform:"scale(1.1)",minPxTriggerSwap:80,onDragEnd:c,dragTimeout:300},l=document,m=l.getElementById(b),n=m.children,o=function(){for(var a=[],b=0;n.length>b;b++)a.push(n[b]);return a}(),q=o.length,r=Array(q),A={handleEvent:function(a){switch(a.type){case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":E(a)}k.stopPropagation&&a.stopPropagation()}};for(var B in d)k[B]=d[B];return C(),{update:D}}var d={horizontally:function(a,b,c){return"function"==typeof b?e(a,{onDragEnd:b}):(b.onDragEnd=c,e(a,b))}};b.DragNSort=d})(Hammer,window);